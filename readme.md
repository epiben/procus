# PROCUS: Patient-reported outcome collection using short messages
A full-fledged system for collecting patient-reported outcome data from respondents via short messages (text messages, SMS).  For now, it uses only CPSMS (cpsms.dk) as the SMS gateway.

The system requires three secrets, stored in three separate files:

- `secrets/cpsms_api_token.txt`: must contain the API token generated by CPSMS to *send* short messages
- `secrets/cpsms_webhook_token.txt`: must contain a token (of your choice) that CPSMS includes in its webhook GET request as a query parameter names `token`
- `secrets/ngrok_config.yaml`: a configuration file for ngrok to establish a secure tunnel, see example below

## Ngrok configuration file
The `secrets/ngrok_config.yaml` file should contain the following information (at least, see https://ngrok.com/docs/ngrok-agent/config/):

```
version: "2"
authtoken: <token>
tunnels:
  fastapi:
    proto: http
    addr: fastapi:5000
    domain: <ngrok_subdomain>.ngrok-free.app
```

## Sending CPSMS-like requests
The file [`curl_requests.http`](/curl_requests.http) contains cURL requests that mimic those of CPSMS through the webhook. The requests in the file use a dummy recipient (Mr McUrl), created at the end of [`postgres/init.sql`](/postgres/init.sql). Because the phone number isn't valid, one can't test this with an actual phone.
